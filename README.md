# 🎓 毕业设计选题查重系统

<div align="center">

专业的毕业设计选题相似度检测工具

[![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)](https://www.python.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

</div>

## 📋 项目简介

毕业设计选题查重系统是一个专门用于检测毕业设计选题相似度的Python工具。它能够自动读取Excel文件中的选题信息，使用自然语言处理技术计算选题之间的相似度，并生成详细的查重报告。

### ✨ 核心特性

- 🔍 **智能相似度检测** - 基于TF-IDF和余弦相似度算法
- 📊 **多格式支持** - 支持 `.xlsx`, `.xls`, `.csv` 格式
- 🎯 **自动班级识别** - 从文件名自动提取班级信息
- 🧹 **数据清洗** - 自动过滤无效题目（待定、入伍等）
- 📈 **详细报告** - 生成包含多个工作表的Excel报告
- 🎨 **专业格式** - 自动美化Excel表格，添加颜色标记
- 📝 **数据规范化** - 统一专业、组织等字段格式

## 🚀 快速开始

### 环境要求

- Python 3.7 或更高版本
- Windows / Linux / macOS

### 安装依赖

```bash
pip install -r requirements.txt
```

### 使用方法

#### 方式1：直接运行（推荐）

```bash
python checker.py
```

#### 方式2：使用批处理文件（Windows）

双击 `run.bat` 文件即可运行。

### 输入输出

**输入**：

- **原始数据**：将Excel文件放入 `原始数据` 文件夹
- **二次提交**（可选）：将修改后的Excel文件放入 `二次提交` 文件夹
- 文件命名建议包含班级信息，如：`汽服2401ZB班.xlsx`

**数据读取规则**：

1. 如果 `二次提交` 文件夹不为空，优先使用二次提交文件夹的数据
2. 同时读取原始数据文件夹作为参考（不与二次提交中的重复文件）
3. 如果 `二次提交` 文件夹为空，则使用原始数据文件夹的数据
4. **数据合并规则**：当同一学生在二次提交和原始数据中都存在时
   - 以二次提交的**课题名称**为准
   - 如果二次提交中某些字段缺失，从原始数据中补充
   - 最终每个学生只保留一条记录

**输出**：

- 查重结果保存在 `查重结果` 文件夹
- 输出文件名格式：`查重结果_YYYYMMDD_HHMMSS.xlsx`

## 📊 输出文件说明

生成的Excel文件包含三个工作表：

### 工作表1：相似题目

列出所有相似度超过阈值（默认75%）的题目对，包含：

- 题目A / 题目B
- 学生A / 学生B
- 导师A / 导师B
- 班级A / 班级B
- 相似度（百分比）

**颜色标记**：
- 🔴 红色背景：相似度 ≥ 85%
- 🟠 橙色背景：相似度 ≥ 80%

### 工作表2：无效题目

列出被判定为无效的题目记录，包括：
- 待定、暂定、空题等无意义题目
- 入伍（已参军）
- 过短的题目

### 工作表3：全部数据

包含所有有效和无效的完整数据（15列）：

1. **序号** - 自动编号
2. **课题名称** - 去除所有空格
3. **可选范围** - 选题范围
4. **所属专业** - 规范化为两个标准值之一
5. **指导教师姓名** - 导师姓名
6. **指导教师工号** - 导师工号
7. **学生姓名** - 学生姓名
8. **学生学号** - 学生学号
9. **学生组织** - 统一为"汽车工程学院"
10. **来源** - 选题来源（学生自选/教师指定）
11. **模板类型** - 统一为"理科"
12. **第二指导教师** - 第二导师（无则显示"无"）
13. **班级(文件名)** - 从文件名提取的班级
14. **来源文件** - 原始Excel文件名
15. **数据状态** - 有效/无效标记

**颜色标记**：
- ⬜ 灰色背景：无效题目

## 🔧 配置说明

### 相似度阈值

在 `checker.py` 文件的 `main()` 函数中修改：

```python
checker = ThesisChecker(
    data_dir="原始数据",
    resubmit_dir="二次提交",
    output_dir="查重结果",
    threshold=0.75  # 修改此值调整相似度阈值（0.0-1.0）
)
```

### 数据目录

默认配置：

- **原始数据目录**：`原始数据` - 初始选题数据
- **二次提交目录**：`二次提交` - 修改后的选题数据（可选）
- **输出目录**：`查重结果`

## 📁 项目结构

```
thesis_checker/
├── checker.py              # 主程序
├── run.bat                 # Windows启动脚本
├── requirements.txt        # 依赖清单
├── README.md              # 项目说明
├── 原始数据/              # 初始选题数据文件夹
│   ├── *.xlsx
│   └── *.xls
├── 二次提交/              # 修改后的选题数据文件夹（可选）
│   ├── *.xlsx
│   └── *.xls
└── 查重结果/              # 输出文件夹
    └── 查重结果_*.xlsx
```

## 🔍 算法说明

### 相似度计算

系统使用以下技术计算选题相似度：

1. **中文分词**：使用 jieba 分词器对题目进行分词
2. **TF-IDF向量化**：将题目转换为TF-IDF向量
3. **余弦相似度**：计算向量之间的余弦相似度

### 无效题目判定

以下情况会被判定为无效题目：

- 题目为空或只有空格
- 题目内容为：待定、暂定、待填、待选、未定、空题、无、nan、入伍
- 去除书名号后长度≤2个字符
- 不包含中文或英文字符

## 📝 数据处理规则

### 字段规范化

| 字段 | 规范化规则 |
|------|----------|
| 课题名称 | 去除所有空格、制表符、NBSP等特殊空白字符 |
| 所属专业 | 只能是"汽车服务工程技术"或"新能源汽车工程技术" |
| 学生组织 | 统一为"汽车工程学院" |
| 来源 | 空值随机填充"学生自选"或"教师指定" |
| 模板类型 | 统一为"理科" |
| 第二指导教师 | 空值填充"无" |

### 班级识别

从文件名自动识别班级，支持格式：
- `汽服2401ZB`、`新能2401D`
- `汽服2201B班`、`汽服2202D`

## 🐛 常见问题

### 1. 程序报错"未找到Excel文件"

**解决方法**：确保将Excel文件放入 `原始数据` 文件夹中。

### 2. 相似度结果不准确

**解决方法**：
- 调整 `threshold` 参数
- 检查题目是否有足够的区分度
- 考虑题目本身的语义相似性

### 3. 某些题目被误判为无效

**解决方法**：修改 `is_valid_title()` 方法中的无效题目判定规则。

## 📄 许可证

本项目采用 MIT 许可证。

## 👨‍💻 作者

Thesis Checker Development Team

## 🙏 致谢

本项目使用了以下优秀的开源库：

- [pandas](https://pandas.pydata.org/) - 数据处理
- [scikit-learn](https://scikit-learn.org/) - 机器学习算法
- [jieba](https://github.com/fxsjy/jieba) - 中文分词
- [openpyxl](https://openpyxl.readthedocs.io/) - Excel文件操作

---

<div align="center">

**如有问题或建议，欢迎反馈！**

Made with ❤️ for Academic Community

</div>
