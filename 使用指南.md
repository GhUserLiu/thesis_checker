# 论文选题查重系统 - 快速使用指南

## 📌 最简单的使用方法

### 第一步:准备数据
将包含选题信息的Excel文件放入项目文件夹中:
- **原始数据/** - 放入初始的选题Excel文件
- **二次提交/** (可选) - 放入修改后的选题Excel文件

支持的文件格式:
- `.xlsx` - Excel文件
- `.xls` - 旧版Excel文件
- `.csv` - CSV文件(GBK编码)

### 第二步:运行程序

**Windows系统:**
```bash
# 方法1: 双击运行
双击 run.bat 文件

# 方法2: 命令行运行
python run.py
```

**Linux/Mac系统:**
```bash
python run.py
```

### 第三步:查看结果
程序运行完成后,打开 `查重结果/` 文件夹,找到最新生成的Excel文件(文件名格式: `查重结果_YYYYMMDD_HHMMSS.xlsx`)

---

## 📊 输出文件说明

Excel文件包含3个工作表:

### 1️⃣ 相似题目
列出所有相似度≥75%的题目对
- 🔴 红色行: 相似度 ≥ 85%
- 🟠 橙色行: 相似度 ≥ 80%
- 🟡 黄色行: 相似度 ≥ 75%

### 2️⃣ 无效题目
列出无效题目(待定、空题、入伍等)
- ⬜ 灰色行: 无效题目

### 3️⃣ 全部数据
包含所有学生的完整信息
- 🟡 黄色: 相似题目
- ⬜ 灰色: 无效题目
- ⬜ 白色: 正常题目

---

## ⚙️ 修改配置

### 修改相似度阈值
打开 `run.py` 文件,找到第48行:
```python
threshold=0.75  # 修改这里,0.75表示75%
```

### 修改文件夹名称
打开 `run.py` 文件,找到第44-46行:
```python
data_dir="原始数据",        # 修改输入文件夹名称
resubmit_dir="二次提交",    # 修改二次提交文件夹名称
output_dir="查重结果",      # 修改输出文件夹名称
```

---

## 🔍 数据读取规则

### 规则1: 二次提交优先
- 如果 `二次提交/` 文件夹**不为空**,优先使用这里的文件
- `原始数据/` 文件夹作为补充,用于填充缺失信息

### 规则2: 学生数据合并
- 同一学生(姓名+学号)只保留一条记录
- 以二次提交的课题名称为准
- 如果二次提交数据缺失字段,从原始数据补充

### 规则3: 支持的数据格式

**标准格式(11列):**
- 课题名称、可选范围、所属专业、指导教师姓名、指导教师工号
- 学生姓名、学生学号、学生组织、来源、模板类型、第二指导教师

**简化格式(5列):**
- 序号、班级、学生姓名、指导教师、论文题目

---

## 💡 常见问题

### Q1: 程序报错"未找到Excel文件"
**A:** 确保将Excel文件放入 `原始数据/` 文件夹中

### Q2: 某些题目被标记为"无效"
**A:** 以下情况会被标记为无效:
- 题目为"待定"、"暂定"、"空题"等
- 题目过短(少于2个字符)
- 学生状态为"入伍"

### Q3: 同一学生出现多条记录
**A:** 系统按"姓名+学号"判断。如果学号不同,即使是同名也视为不同学生

### Q4: 想只检测部分班级
**A:** 将需要检测的文件放入 `原始数据/` 文件夹,不需要的文件移走即可

---

## 📞 获取帮助

遇到问题?
1. 查看完整文档: [README.md](README.md)
2. 检查Excel文件格式是否正确
3. 确保已安装所有依赖: `pip install -r requirements.txt`

---

## 📦 依赖安装

首次使用需要安装依赖库:

```bash
pip install -r requirements.txt
```

需要安装的库:
- pandas - 数据处理
- scikit-learn - 相似度计算
- jieba - 中文分词
- openpyxl - Excel文件操作

---

**祝使用愉快!** 🎉
